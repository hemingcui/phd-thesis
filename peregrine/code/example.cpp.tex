% Remember to use the lgrind style

\Head{}
\File{example.cpp}{2014}{12}{17}{17:23}{949}
\L{\LB{}\Tab{5}{\K{int}_\V{size};_//_\V{total}_\V{size}_\V{of}_\V{data}}}
\L{\LB{}\Tab{5}{\K{int}_\V{nthread};_//_\V{total}_\V{number}_\V{of}_\V{threads}}}
\L{\LB{}\Tab{5}{\K{unsigned}_\K{long}_\V{result}_=_\N{0};}}
\L{\LB{}}
\index{main}\Proc{main}\L{\LB{}\Tab{5}{\K{int}_\V{main}(\K{int}_\V{argc},_\K{char}_*\V{argv}[\,])_\{}}
\L{\LB{_\V{L1}:}\Tab{9}{\V{nthread}_=_\V{atoi}(\V{argv}[\N{1}]);}}
\L{\LB{_\V{L2}:}\Tab{9}{\V{size}_=_\V{atoi}(\V{argv}[\N{2}]);}}
\L{\LB{_\V{L3}:}\Tab{9}{\V{assert}(\V{nthread}\>\N{0}_\&\&_\V{size}\>=\V{nthread});}}
\L{\LB{_\V{L4}:}\Tab{9}{\K{for}(\K{int}_\V{i}=\N{1};_\V{i}\<\V{nthread};_++\V{i})}}
\L{\LB{_\V{L5}:}\Tab{13}{\V{pthread\_create}(.\,.\,.,_\V{worker},_\V{NULL});}}
\L{\LB{_\V{L6}:}\Tab{9}{\V{worker}(\V{NULL});}}
\L{\LB{}\Tab{8}{//_\V{NOTE}:_\V{missing}_@\V{pthread\_join}()@}}
\L{\LB{_\V{L7}:}\Tab{9}{\K{if}(\V{atoi}(\V{argv}[\N{3}])_==_\N{1})}}
\L{\LB{_\V{L8}:}\Tab{13}{\V{result}_+=_.\,.\,.;_//_\V{race}_\V{with}_\V{line}_@\V{L15}@}}
\L{\LB{_\V{L9}:}\Tab{9}{\V{printf}(\S{}\3result_=_\%lu\2n\3\SE{},_\V{result});_//_\V{race}_\V{with}_\V{line}_@\V{L15}@}}
\L{\LB{}\Tab{9}{.\,.\,.}}
\L{\LB{}\Tab{5}{\}}}
\index{worker}\Proc{worker}\L{\LB{}\Tab{5}{\K{void}_*\V{worker}(\K{void}_*\V{arg})_\{}}
\L{\LB{\V{L10}:}\Tab{9}{\K{char}_*\V{data}_=_\V{malloc}(\V{size}/\V{nthread});}}
\L{\LB{\V{L11}:}\Tab{9}{\V{read}(.\,.\,.,_\V{data},_\V{size}/\V{nthread});}}
\L{\LB{\V{L12}:}\Tab{9}{\K{for}(\K{int}_\V{i}=\N{0};_\V{i}\<\V{size}/\V{nthread};_++\V{i})}}
\L{\LB{\V{L13}:}\Tab{13}{\V{data}[\V{i}]_=_.\,.\,.;_//_\V{compute}_\V{using}_@\V{data}@}}
\L{\LB{\V{L14}:}\Tab{9}{\V{pthread\_mutex\_lock}(\&\V{mutex});}}
\L{\LB{\V{L15}:}\Tab{9}{\V{result}_+=_.\,.\,.;_//_\V{race}_\V{with}_\V{lines}_@\V{L8}@_\V{and}_@\V{L9}@}}
\L{\LB{\V{L16}:}\Tab{9}{\V{pthread\_mutex\_unlock}(\&\V{mutex});}}
\L{\LB{}\Tab{9}{.\,.\,.}}
\L{\LB{}\Tab{5}{\}}}
