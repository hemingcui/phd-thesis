% Remember to use the lgrind style

\Head{}
\File{input\-race.cpp}{2014}{12}{22}{16:17}{1802}
\L{\LB{\C{}//_detect_input-dependent_races,_and_add_involved_dynamic_instruction_instances_to_\CE{}\V{slicing\_targets}\C{}\CE{}}}
\L{\LB{\C{}//_used_by_the_inter-thread_step._\CE{}\V{r1}\C{}_and_\CE{}\V{r2}\C{}_are_two_concurrent_regions\CE{}}}
\index{detect\_input\_dependent\_races}\Proc{detect\_input\_dependent\_races}\L{\LB{\K{void}_\V{detect\_input\_dependent\_races}(\V{r1},_\V{r2})_\{}}
\L{\LB{}\Tab{2}{\K{for}_(\V{i1},_\V{i2})_\V{in}_(\V{r1},_\V{r2})_\{_\C{}//_iterate_through_all_instruction_pairs_in_r1,_r2\CE{}}}
\L{\LB{}\Tab{4}{\K{if}_(\V{neither}_\V{i1}_\V{nor}_\V{i2}_\V{is}_\V{a}_\V{branch}_\V{instruction})_\{}}
\L{\LB{}\Tab{6}{\K{if}(\V{mayrace}(\V{i1},_\V{i2}))}}
\L{\LB{}\Tab{8}{\{_\V{slicing\_targets}.\V{add}(\V{i1});_\V{slicing\_targets}.\V{add}(\V{i2});_\}_\C{}//_add_\CE{}\V{i1}\C{}_and_\CE{}\V{i2}\C{}_to_slicing_targets\CE{}}}
\L{\LB{}\Tab{4}{\}_\K{else}_\K{if}_(\V{exactly}_\V{one}_\V{of}_\V{i1},_\V{i2}_\V{is}_\V{a}_\V{branch}_\V{instruction})_\{}}
\L{\LB{}\Tab{6}{\V{br}_=_\V{branch}_\V{instruction}_\V{in}_\V{i1},_\V{i2};}}
\L{\LB{}\Tab{6}{\V{inst}_=_\V{the}_\V{other}_\V{instruction}_\V{in}_\V{i1},_\V{i2};}}
\L{\LB{}\Tab{6}{\V{nottaken}_=_\V{the}_\V{not}_\V{taken}_\V{branch}_\V{of}_\V{br}_\V{in}_\V{the}_\V{execution}_\V{trace};}}
\L{\LB{}\Tab{6}{\K{if}(\V{mayrace\_br}(\V{br},_\V{nottaken},_\V{inst}))_\{}}
\L{\LB{}\Tab{8}{\V{taken}_=_\V{the}_\V{taken}_\V{branch}_\V{of}_\V{br}_\V{in}_\V{trace};_\C{}//_add_the_taken_branch_of_\CE{}\V{br}\C{}_to_slicing_targets\CE{}}}
\L{\LB{}\Tab{8}{\V{slicing\_targets}.\V{add\_br}(\V{br},_\V{taken});}}
\L{\LB{}\Tab{6}{\}}}
\L{\LB{}\Tab{4}{\}_\K{else}_\{_\C{}//_both_\CE{}\V{i1}\C{},_\CE{}\V{i2}\C{}_are_branches\CE{}}}
\L{\LB{}\Tab{6}{\V{nottaken1}_=_\V{the}_\V{not}_\V{taken}_\V{branch}_\V{of}_\V{i1}_\V{in}_\V{trace};}}
\L{\LB{}\Tab{6}{\V{nottaken2}_=_\V{the}_\V{not}_\V{taken}_\V{branch}_\V{of}_\V{i2}_\V{in}_\V{trace};}}
\L{\LB{}\Tab{6}{\K{if}(\V{mayrace\_br\_br}(\V{i1},_\V{nottaken1},_\V{i2},_\V{nottaken2})_\{}}
\L{\LB{}\Tab{8}{\V{taken1}_=_\V{the}_\V{taken}_\V{branch}_\V{of}_\V{i1}_\V{in}_\V{trace};}}
\L{\LB{}\Tab{8}{\V{slicing\_targets}.\V{add\_br}(\V{i1},_\V{taken1});}}
\L{\LB{}\Tab{6}{\}}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}\Tab{2}{\}}}
\L{\LB{\}}}
\index{mayrace}\Proc{mayrace}\L{\LB{\K{bool}_\V{mayrace}(\V{i1},_\V{i2})_\{_\K{return}_\V{mayalias}(\V{i1},_\V{i2})_\&\&_((\V{i1}_\V{is}_\V{a}_\V{store})_\|\,\|_(\V{i2}_\V{is}_\V{a}_\V{store}));_\}}}
\index{mayrace\_br}\Proc{mayrace\_br}\L{\LB{\K{bool}_\V{mayrace\_br}(\V{br},_\V{nottaken},_\V{inst})_\{_\C{}//_return_true_if_the_not-taken_branch_of_\CE{}\V{br}\C{}_may_race_with_\CE{}\V{inst}\C{}\CE{}}}
\L{\LB{}\Tab{2}{\K{for}_\V{i}_\V{in}_(\V{instructions}_\V{in}_\V{the}_\V{nottaken}_\V{branch}_\V{of}_\V{br})}}
\L{\LB{}\Tab{4}{\K{if}(\V{mayrace}(\V{i},_\V{inst}))_\K{return}_\K{true};}}
\L{\LB{}\Tab{2}{\K{return}_\K{false};_\}}}
\L{\LB{\C{}//_return_true_if_the_not-taken_branch_of_\CE{}\V{br1}\C{}_may_race_with_the_not-taken_branch_of_\CE{}\V{br2}\C{}\CE{}}}
\index{mayrace\_br\_br}\Proc{mayrace\_br\_br}\L{\LB{\K{bool}_\V{mayrace\_br\_br}(\V{br1},_\V{nottaken1},_\V{br2},_\V{nottaken2})_\{}}
\L{\LB{}\Tab{2}{\K{for}_\V{inst}_\V{in}_(\V{instructions}_\V{in}_\V{the}_\V{nottaken2}_\V{branch}_\V{of}_\V{br2})}}
\L{\LB{}\Tab{4}{\K{if}(\V{mayrace\_br}(\V{br1},_\V{nottaken1},_\V{inst}))_\K{return}_\K{true};}}
\L{\LB{}\Tab{2}{\K{return}_\K{false};_\}}}
