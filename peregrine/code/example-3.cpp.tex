% Remember to use the lgrind style

\Head{}
\File{example\-3.cpp}{2014}{12}{21}{22:33}{1523}
\L{\LB{\K{int}_*\V{matrix}_=_\V{NULL};}}
\L{\LB{\K{int}_\V{size};_\C{}//_size_of_\CE{}\V{matrix}\C{}\CE{}}}
\L{\LB{\K{int}_\V{nthread};_\C{}//_total_number_of_threads\CE{}}}
\L{\LB{\K{unsigned}_\K{long}_\V{finishtime}_=_\N{0};}}
\L{\LB{}}
\index{main}\Proc{main}\L{\LB{\K{void}_\V{main}(\K{int}_\V{argc},_\K{char}_*\V{argv}[\,])_\{}}
\L{\LB{}\Tab{4}{\V{nthread}_=_\V{atoi}(\V{argv}[\N{1}]);}}
\L{\LB{}\Tab{4}{\V{size}_=_\V{atoi}(\V{argv}[\N{2}]);}}
\L{\LB{}\Tab{4}{\V{matrix}_=_(\K{int}*)\V{malloc}(\V{size}*\K{sizeof}(\K{int}));}}
\L{\LB{}\Tab{4}{.\,.\,._\C{}//_initialize_\CE{}\C{}\CE{}}}
\L{\LB{}\Tab{4}{\V{pthread\_create}(.\,.\,.,_\V{SlaveStart},_(\K{void}*)\N{1});}}
\L{\LB{}\Tab{4}{\V{pthread\_create}(.\,.\,.,_\V{SlaveStart2},_(\K{void}*)\N{2});}}
\L{\LB{}\Tab{4}{\V{SlaveStart}(\N{0});}}
\L{\LB{}\Tab{4}{\C{}//_NOTE:_missing_\CE{}\V{pthread\_join}()\C{}\CE{}}}
\L{\LB{}\Tab{4}{\V{printf}(\S{}\3finish_time:_\%lu\2n\3\SE{},_\V{finishtime});}}
\L{\LB{\}}}
\L{\LB{}}
\index{SlaveStart0}\Proc{SlaveStart0}\L{\LB{\K{void}*_\V{SlaveStart0}(\K{void}_*\V{arg})_\{}}
\L{\LB{}\Tab{4}{\K{int}_*\V{upriv}_=_(\K{int}*)\V{malloc}(.\,.\,.);_\C{}//_temp_buffer\CE{}}}
\L{\LB{}\Tab{4}{\K{int}_\V{start}_=_\N{0};}}
\L{\LB{}\Tab{4}{\K{int}_\V{end}_=_\V{size}/\V{nthread};}}
\L{\LB{}\Tab{4}{\K{for}(\K{int}_\V{i}=\V{start};_\V{i}\<=\V{end};_++\V{i})_\{}}
\L{\LB{}\Tab{8}{\C{}//_compute_using_\CE{}\V{upriv}\C{}_and_\CE{}\V{matrix}\C{}\CE{}}}
\L{\LB{}\Tab{8}{\V{upriv}[.\,.\,.]_=_\V{matrix}[\V{i}]_.\,.\,.;}}
\L{\LB{}\Tab{8}{\V{matrix}[\V{i}]_=_.\,.\,.;}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}\Tab{4}{\V{pthread\_barrier\_wait}(.\,.\,.);}}
\L{\LB{}\Tab{4}{\V{finishtime}_=_.\,.\,.;}}
\L{\LB{\}}}
\L{\LB{}}
\index{SlaveStart1}\Proc{SlaveStart1}\L{\LB{\K{void}*_\V{SlaveStart1}(\K{void}_*\V{arg})_\{}}
\L{\LB{}\Tab{4}{\K{int}_*\V{upriv}_=_(\K{int}*)\V{malloc}(.\,.\,.);_\C{}//_temp_buffer\CE{}}}
\L{\LB{}\Tab{4}{\K{int}_\V{start}_=_\V{size}/\V{nthread};}}
\L{\LB{}\Tab{4}{\K{int}_\V{end}_=_\V{size}/\V{nthread}_*_\N{2};}}
\L{\LB{}\Tab{4}{\K{for}(\K{int}_\V{i}=\V{start};_\V{i}\<=\V{end};_++\V{i})_\{}}
\L{\LB{}\Tab{8}{\C{}//_compute_using_\CE{}\V{upriv}\C{}_and_\CE{}\V{matrix}\C{}\CE{}}}
\L{\LB{}\Tab{8}{\V{upriv}[.\,.\,.]_=_\V{matrix}[\V{i}]_.\,.\,.;}}
\L{\LB{}\Tab{8}{\V{matrix}[\V{i}]_=_.\,.\,.;}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}\Tab{4}{\V{pthread\_barrier\_wait}(.\,.\,.);}}
\L{\LB{}\Tab{4}{\V{finishtime}_=_.\,.\,.;}}
\L{\LB{\}}}
\L{\LB{}}
\index{SlaveStart2}\Proc{SlaveStart2}\L{\LB{\K{void}*_\V{SlaveStart2}(\K{void}_*\V{arg})_\{}}
\L{\LB{}\Tab{4}{\K{int}_*\V{upriv}_=_(\K{int}*)\V{malloc}(.\,.\,.);_\C{}//_temp_buffer\CE{}}}
\L{\LB{}\Tab{4}{\K{int}_\V{start}_=_\V{size}/\V{nthread}_*_\N{2};}}
\L{\LB{}\Tab{4}{\K{int}_\V{end}_=_\V{size}/\V{nthread}_*_\N{3};}}
\L{\LB{}\Tab{4}{\K{for}(\K{int}_\V{i}=\V{start};_\V{i}\<=\V{end};_++\V{i})_\{}}
\L{\LB{}\Tab{8}{\C{}//_compute_using_\CE{}\V{upriv}\C{}_and_\CE{}\V{matrix}\C{}\CE{}}}
\L{\LB{}\Tab{8}{\V{upriv}[.\,.\,.]_=_\V{matrix}[\V{i}]_.\,.\,.;}}
\L{\LB{}\Tab{8}{\V{matrix}[\V{i}]_=_.\,.\,.;}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}\Tab{4}{\V{pthread\_barrier\_wait}(.\,.\,.);}}
\L{\LB{}\Tab{4}{\V{finishtime}_=_.\,.\,.;}}
\L{\LB{\}}}
